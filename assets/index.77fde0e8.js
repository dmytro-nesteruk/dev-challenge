var h=Object.defineProperty;var u=(s,e,i)=>e in s?h(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i;var t=(s,e,i)=>(u(s,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function i(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(n){if(n.ep)return;n.ep=!0;const c=i(n);fetch(n.href,c)}})();var o=(s=>(s.airplane="airplane",s.helicopter="helicopter",s.rocket="rocket",s.drone="drone",s.explosion="explosion",s))(o||{});const g="/dev-challenge/assets/rocket-white.f0779ea1.svg",p="/dev-challenge/assets/drone-white.db8501a6.svg",m="/dev-challenge/assets/airplane-white.58eb1318.svg",b="/dev-challenge/assets/helicopter-white.53fa16e7.svg",v="/dev-challenge/assets/explosion-white.5bbc322b.svg";class f{constructor({defaultDanger:e=o.rocket,emitt:i}){t(this,"buttons");t(this,"emitt");t(this,"availableDangers");t(this,"element");t(this,"selectedDanger");t(this,"handleClick",e=>{const r=e.target.closest("button");if(!r)return;const c=r.id.split("-").at(-1),a=this.availableDangers.find(d=>d===c);a&&a!==this.selectedDanger&&(this.selectedDanger=a,this.emitt("DANGER_TYPE_CHANGED",this.selectedDanger),this.update(this.selectedDanger))});t(this,"init",()=>{this.element.classList.add("danger-picker"),this.buttons=[this.createBtn(g,o.rocket,this.selectedDanger===o.rocket),this.createBtn(p,o.drone,this.selectedDanger===o.drone),this.createBtn(m,o.airplane,this.selectedDanger===o.airplane),this.createBtn(b,o.helicopter,this.selectedDanger===o.helicopter),this.createBtn(v,o.explosion,this.selectedDanger===o.explosion)],this.element.addEventListener("click",this.handleClick),this.buttons.forEach(e=>{this.element.append(e)})});t(this,"update",e=>{const i=this.buttons.find(n=>n.id.includes(e));if(!i)return;const r=this.buttons.find(n=>n.classList.contains("active"));r&&r.classList.remove("active"),i.classList.add("active")});t(this,"createBtn",(e,i,r=!1)=>{const n=document.createElement("button"),c=this.createIcon(e),a=this.createLabel(i.toUpperCase());return n.id=`danger-picker-button-${i}`,n.classList.add("danger-picker-button"),r&&n.classList.add("active"),n.append(c),n.append(a),n});t(this,"createIcon",e=>{const i=document.createElement("img");return i.src=e,i.classList.add("danger-picker-button__icon"),i.height=24,i.width=24,i});t(this,"createLabel",e=>{const i=document.createElement("span");return i.classList.add("danger-picker-button__label"),i.innerText=e,i});this.selectedDanger=e,this.emitt=i,this.availableDangers=Object.values(o),this.element=document.createElement("div"),this.buttons=[],this.init()}}const l="/src/assets/icons/";class E{constructor({defaultDanger:e,eventEmitter:i}){t(this,"selectedDanger");t(this,"container");t(this,"button");t(this,"icon");t(this,"emitter");t(this,"init",()=>{this.emitter.subscribe({event:"DANGER_TYPE_CHANGED",callback:e=>{this.update(e)}}),this.container.classList.add("selected-danger"),this.button.append(this.icon),this.button.addEventListener("click",this.handleClick),this.container.append(this.button)});t(this,"createBtn",()=>{const e=document.createElement("button");return e.classList.add("selected-danger-button"),e});t(this,"createIcon",e=>{const i=document.createElement("img");return i.src=e,i.height=128,i.width=128,i});t(this,"handleClick",()=>{this.emitter.notifySubscribers("DANGER_SUBMIT_CLICK",this.selectedDanger)});t(this,"update",e=>{this.selectedDanger=e,this.icon.src=`${l}/${e}.svg`});this.selectedDanger=e,this.emitter=i,this.container=document.createElement("div"),this.button=this.createBtn(),this.icon=this.createIcon(`${l}/${this.selectedDanger}.svg`),this.init()}get element(){return this.container}}class D{constructor({eventEmitter:e}){t(this,"eventEmitter");t(this,"container");t(this,"accelerometer");t(this,"init",()=>{"Accelerometer"in window?(this.accelerometer=new Accelerometer,this.accelerometer.start(),this.eventEmitter.notifySubscribers("DANGER_TYPE_CHANGED","text")):console.log("Accelerometer not supported"),window.DeviceMotionEvent?window.addEventListener("devicemotion",this.update):console.log("Not supported")});t(this,"update",e=>{var i,r,n,c,a;console.log("updated"),console.log((i=e.acceleration)==null?void 0:i.x),console.log((r=e.acceleration)==null?void 0:r.y),console.log((n=e.acceleration)==null?void 0:n.z),this.container.innerText=(a=(c=e.acceleration)==null?void 0:c.x)==null?void 0:a.toString()});this.eventEmitter=e,this.container=document.createElement("div"),this.accelerometer=void 0,this.init()}get element(){return this.container}}class k{constructor(){t(this,"subscribers");t(this,"subscribe",e=>{this.subscribers.push(e)});t(this,"notifySubscribers",(e,i)=>{this.subscribers.length&&this.subscribers.forEach(r=>{r.event===e&&r.callback(i)})});t(this,"unsubscribe",e=>{this.subscribers.length&&this.subscribers.filter(({event:i,callback:r})=>i!==e.event&&r!==e.callback)});this.subscribers=[]}}class w{constructor(){t(this,"id");t(this,"geoposition");t(this,"init",()=>{if(!navigator.geolocation||!navigator.geolocation.watchPosition)throw new Error("Geoposition API not supported in your browser.");this.id=navigator.geolocation.watchPosition(e=>{this.geoposition=e.coords,console.log(e)},e=>{console.log(e)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})});t(this,"getPosition",()=>this.geoposition);t(this,"clear",()=>{this.id&&navigator.geolocation.clearWatch(this.id)});this.id=null,this.geoposition=null,this.init()}}class A{constructor(){t(this,"app");t(this,"selectedDanger");t(this,"accelerometer");t(this,"eventEmitter");t(this,"geolocation");t(this,"submitDanger");t(this,"dangerPicker");t(this,"children");this.app=document.createElement("div"),this.selectedDanger=o.helicopter,this.eventEmitter=new k,this.accelerometer=new D({eventEmitter:this.eventEmitter}),this.geolocation=new w,this.submitDanger=new E({defaultDanger:this.selectedDanger,eventEmitter:this.eventEmitter}),this.dangerPicker=new f({defaultDanger:this.selectedDanger,emitt:this.eventEmitter.notifySubscribers}),this.children=[this.accelerometer.element,this.submitDanger.element,this.dangerPicker.element],this.eventEmitter.subscribe({event:"DANGER_TYPE_CHANGED",callback:e=>{this.selectedDanger=e}}),this.eventEmitter.subscribe({event:"DANGER_SUBMIT_CLICK",callback:e=>{console.log(e)}})}render(e){this.children.forEach(i=>{this.app.append(i)}),e.append(this.app)}}const L=document.querySelector("#app"),y=new A;y.render(L);
